(this.webpackJsonpminesweeper=this.webpackJsonpminesweeper||[]).push([[0],{13:function(e,t,n){},14:function(e,t,n){"use strict";n.r(t);var a=n(0),s=n.n(a),r=n(6),i=n.n(r),l=n(7),o=n(1),c=n(2),u=n(4),m=n(3),f=(n(13),function(e){return e.data.isPressed?e.data.hasMine?s.a.createElement("div",{className:"bomb cell",onClick:function(){return e.tryPress(e.data)},onContextMenu:function(e){e.preventDefault()}}):0===e.data.minesAround?s.a.createElement("div",{className:"pressed cell",onClick:function(){return e.tryPress(e.data)},onContextMenu:function(t){t.preventDefault(),e.flag(e.data)}}):s.a.createElement("div",{className:"pressed cell",onClick:function(){return e.tryPress(e.data)},onContextMenu:function(t){t.preventDefault(),e.flag(e.data)}},e.data.minesAround):e.data.hasFlag?s.a.createElement("div",{className:"flagged cell",onClick:function(){return e.tryPress(e.data)},onContextMenu:function(t){t.preventDefault(),e.flag(e.data)}}):s.a.createElement("div",{className:"cell",onClick:function(){return e.tryPress(e.data)},onContextMenu:function(t){t.preventDefault(),e.flag(e.data)}})}),d=function(e){var t=e.cells.map((function(t,n){return s.a.createElement(f,{key:n,data:t,tryPress:e.tryPress,flag:e.flag})}));return s.a.createElement("div",{className:"row"},t)},p=function(e){Object(u.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).createGrid=function(e){for(var t=[],n=0;n<e.rows;n++){t.push([]);for(var a=0;a<e.columns;a++)t[n].push({x:a,y:n,minesAround:0,hasMine:!1,isPressed:!1,hasFlag:!1})}for(var s=0;s<e.mines;s++){var r=Math.floor(Math.random()*e.rows),i=Math.floor(Math.random()*e.columns),l=t[r][i];l.hasMine?s--:l.hasMine=!0}return t},a.tryPress=function(e){"ended"!==a.props.game&&"won"!==a.props.game&&new Promise((function(t){t(a.countNeighbours(e))})).then((function(t){var n=a.state.rows,s=n[e.y][e.x];if(s.hasMine&&0===a.props.openedCells){var r=a.createGrid(a.props);a.setState({rows:r},(function(){a.tryPress(e)}))}else s.isPressed||e.hasFlag||(a.props.onCellInspect(),s.isPressed=!0,s.minesAround=t,a.setState({rows:n}),s.hasMine||0!==t||a.findEmptyCell(e),s.hasMine&&0!==a.props.openedCells&&a.props.finishGame())}))},a.countNeighbours=function(e){for(var t=0,n=-1;n<=1;n++)for(var s=-1;s<=1;s++)if(e.y+n>=0&&e.x+s>=0){var r=n+e.y,i=s+e.x;r<a.state.rows.length&&i<a.state.rows[0].length&&(!a.state.rows[r][i].hasMine||0===n&&0===s||t++)}return t},a.findEmptyCell=function(e){for(var t=a.state.rows,n=-1;n<=1;n++)for(var s=-1;s<=1;s++)if(e.y+n>=0&&e.x+s>=0){var r=n+e.y,i=s+e.x;r<a.state.rows.length&&i<a.state.rows[0].length&&(t[r][i].hasMine||t[r][i].isPressed||a.tryPress(t[r][i]))}},a.flag=function(e){var t=a.state.rows;"ended"!==a.props.game&&"won"!==a.props.game&&(e.isPressed||(e.hasFlag=!e.hasFlag,a.setState({rows:t}),a.props.changeFlagsNumber(e.hasFlag?-1:1)))},a.state={rows:a.createGrid(e)},a}return Object(c.a)(n,[{key:"componentWillReceiveProps",value:function(e){this.props.openedCells>e.openedCells&&this.setState({rows:this.createGrid(e)})}},{key:"render",value:function(){var e=this,t=this.state.rows.map((function(t,n){return s.a.createElement(d,{cells:t,key:n,tryPress:e.tryPress,flag:e.flag})}));return s.a.createElement("div",{className:"grid"},t)}}]),n}(a.Component),h=function(e){var t=Math.floor(e.time/60),n=e.time-60*t||0,a=t+":"+(n<10?"0":"")+n;return s.a.createElement("div",{className:"grid-header"},s.a.createElement("div",{className:"flags"},e.flags),s.a.createElement("button",{className:"reset",onClick:e.reset},"RESET"),s.a.createElement("div",{className:"timer"},a))},g=function(e){Object(u.a)(n,e);var t=Object(m.a)(n);function n(){var e;return Object(o.a)(this,n),(e=t.call(this)).tick=function(){if(e.state.openedCells>0&&"running"===e.state.game){var t=e.state.time+1;e.setState({time:t})}},e.setInterval=function(t,n){e.intervals.push(setInterval(t,n))},e.reset=function(){e.intervals.map(clearInterval),e.setState(Object(l.a)({},e.savedState),(function(){e.intervals=[]}))},e.finishGame=function(){e.setState({game:"ended"})},e.handleCellInspect=function(){"running"!==e.state.game&&0===e.state.openedCells&&e.setState({game:"running"},(function(){e.setInterval(e.tick,1e3)})),e.setState((function(e){return{openedCells:e.openedCells+1}}))},e.changeFlagsNumber=function(t){e.setState({flags:e.state.flags+t})},e.winning=function(){e.state.mines+e.state.openedCells>=e.state.columns*e.state.rows&&e.setState({game:"won"})},e.state={openedCells:0,time:0,rows:10,columns:10,mines:15,flags:15,game:"pending"},e.savedState=e.state,e}return Object(c.a)(n,[{key:"componentWillMount",value:function(){this.intervals=[]}},{key:"componentDidUpdate",value:function(){"running"===this.state.game&&this.winning()}},{key:"render",value:function(){return s.a.createElement("div",{className:"minesweeper"},s.a.createElement(h,{time:this.state.time,flags:this.state.flags,reset:this.reset}),s.a.createElement(p,{game:this.state.game,openedCells:this.state.openedCells,rows:this.state.rows,columns:this.state.columns,mines:this.state.mines,changeFlagsNumber:this.changeFlagsNumber,onCellInspect:this.handleCellInspect,finishGame:this.finishGame}))}}]),n}(a.Component);i.a.render(s.a.createElement(s.a.StrictMode,null,s.a.createElement(g,null)),document.getElementById("root"))},8:function(e,t,n){e.exports=n(14)}},[[8,1,2]]]);
//# sourceMappingURL=main.33fa6db2.chunk.js.map